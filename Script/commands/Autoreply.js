const fs = global.nodemodule["fs-extra"];
const path = global.nodemodule["path"];

module.exports.config = {
  name: "autoreplybot",
  version: "8.0.0",
  hasPermssion: 0,
  credits: "ЁЭРЗЁЭРлЁЭРвЁЭРЭЁЭРиЁЭР▓ ЁЭРЗЁЭРиЁЭРмЁЭРмЁЭРЮЁЭРз",
  description: "Auto response bot with all default triggers and custom add/remove system",
  commandCategory: "No Prefix",
  usages: "[add/remove/list]",
  cooldowns: 3,
};

// JSON path for saved triggers
const dataPath = path.join(__dirname, "cache", "autoreply.json");

// ЁЯза Default replies (рждрзЛржорж╛рж░ рж╕ржм ржжрзЗржУрзЯрж╛ рж▓рж╛ржЗржи)
const defaultReplies = {
  "miss you": "ржЕрж░рзЗржХ ржмрзЗржбрж╛рж░рзЗ Miss ржирж╛ ржХрж░рзЗ xan ржорзЗржпрж╝рзЗ рж╣рж▓рзЗ ржмрж╕ рж╣рзГржжржпрж╝ рж░рзЗ рж╣рж╛ржЩрзНржЧрж╛ ржХрж░рзЛЁЯШ╢ЁЯС╗ЁЯШШ",
  "kiss de": "ржХрж┐рж╕ ржжрж┐рж╕ ржирж╛ рждрзЛрж░ ржорзБржЦрзЗ ржжрзВрж░ ржЧржирзНржз ржХржпрж╝ржжрж┐ржи ржзрж░рзЗ ржжрж╛ржБржд ржмрзНрж░рж╛рж╢ ржХрж░рж┐рж╕ ржирж╛ржЗЁЯдм",
  "ЁЯСН": "рж╕рж░ ржПржЦрж╛ржи ржерзЗржХрзЗ рж▓рж╛ржЗржХрж╛рж░ ржЖржмрж╛рж▓..!ЁЯР╕ЁЯдгЁЯСНтЫПя╕П",
  "help": "Prefix de sala",
  "hi": "ржПржд рж╣рж╛ржЗ-рж╣рзНржпрж╛рж▓рзЛ ржХрж░ ржХрзНржпрж╛ржи ржкрзНрж░рж┐ржУ..!ЁЯШЬЁЯл╡",
  "bc": "SAME TO YOUЁЯШК",
  "pro": "Khud k0o KYa LeGend SmJhTi Hai ЁЯШВ",
  "good morning": "GOOD MORNING ржжрж╛ржд ржмрзНрж░рж╛рж╢ ржХрж░рзЗ ржЦрзЗрзЯрзЗ ржирзЗржУЁЯШЪ",
  "tor ball": "~ ржПржЦржирзЛ ржмрж╛рж▓ ржЙржарзЗ ржирж╛ржЗ ржирж╛ржХрж┐ рждрзЛржорж╛рж░?? ЁЯдЦ",
  "hridoy": "ржЙржирж┐ ржПржЦржи ржХрж╛ржЬрзЗ ржмрж┐ржЬрж┐ ржЖржЫрзЗ ржХрж┐ ржмрж▓ржмрзЗржи ржЖржорж╛ржХрзЗ ржмрж▓рждрзЗ ржкрж╛рж░рзЗржи..!ЁЯШШ",
  "owner": "тАО[ЁЭРОЁЭРЦЁЭРНЁЭРДЁЭРС:тШЮ Hridoy HossenтШЬ\nFacebook: https://www.facebook.com/profile.php?id=100048786044500\nWhatsApp: +880174495****]",
  "admin": "He is Hridoy рждрж╛ржХрзЗ рж╕ржмрж╛ржЗ Kakashi  рж╣рж┐рж╕рзЗржмрзЗ ржЪрж┐ржирзЗЁЯШШтШ║я╕П",
  "babi": "ржП рждрзЛ рж╣рж╛ржЫрж┐ржирж╛ рж╣рзЗ ржорзЗрж░рзЗ ржжрж┐рж▓ржХрж┐ ржжрж╛рж░ржХрж╛ржи рж╣рзЗ ржорзЗрж░рж┐ ржЬрж╛ржи рж╣рзЗЁЯШН.",
  "chup": "рждрзБржЗ ржЪрзБржк ржЪрзБржк ржХрж░ ржкрж╛ржЧрж▓ ржЫрж╛ржЧрж▓",
  "assalamualaikum": "┘И┘О╪╣┘О┘Д┘О┘К┘Т┘Г┘П┘Е┘П ╪з┘Д╪│┘О┘С┘Д┘О╪з┘Е┘П ┘И┘О╪▒┘О╪н┘Т┘Е┘О╪й┘П ╪з┘Д┘Д┘З┘Р ┘И┘О╪и┘О╪▒┘О┘Г┘О╪з╪к┘П┘З┘П ЁЯТЦ",
  "fork": "ржмрж╕ ржПрж░ ржХрж╛ржЫрзЗ ржЪрзЗржпрж╝рзЗ ржжрзЗржЦ ржжрж┐рж▓рзЗ ржнрж╛рж▓рзЛ ржЖрж░ ржирж╛ ржжрж┐рж▓рзЗ ржЖрж░рзЛ ржнрж╛рж▓рзЛред",
  "kiss me": "рждрзБржорж┐ ржкржБржЪрж╛ рждрзЛржорж╛ржХрзЗ ржХрж┐рж╕ ржжрж┐ржмрзЛ ржирж╛ ЁЯдн",
  "thanks": "ржПрждрзЛ ржзржирзНржпржмрж╛ржж ржирж╛ ржжрж┐ржпрж╝рзЗ ржЖржорж╛рж░ ржмрж╕ рж╣рзГржжржпрж╝ рж░рзЗ рждрзЛрж░ ржЧрж╛рж░рзНрж▓ржлрзНрж░рзЗржирзНржб ржЯрж╛ ржжрж┐ржпрж╝рзЗ ржжрзЗ..!ЁЯР╕ЁЯе╡",
  "i love you": "ржорзЗржпрж╝рзЗ рж╣рж▓рзЗ ржЖржорж╛рж░ ржмрж╕ рж╣рзГржжржпрж╝ ржПрж░ ржЗржиржмржХрзНрж╕рзЗ ржПржЦрзБржирж┐ ржЧрзБржБрждрж╛ ржжрж┐ржиЁЯлвЁЯШ╗",
  "by": "ржХрж┐рж░рзЗ рждрзБржЗ ржХржЗ ржпрж╛рж╕ ржХрзЛржи ржорзЗржпрж╝рзЗрж░ рж╕рж╛ржерзЗ ржЪрж┐ржкрж╛ржпрж╝ ржпрж╛ржмрж┐..!ЁЯМЪЁЯМ╢я╕П",
  "ami hridoy": "рж╣рзНржпрж╛ ржмрж╕ ржХрзЗржоржи ржЖржЫрзЗржи..?тШ║я╕П",
  "bot er baccha": "ржЖржорж╛рж░ ржмрж╛ржЪрзНржЪрж╛ рждрзЛ рждрзЛржорж╛рж░ ржЧрж╛рж░рзНрж▓ржлрзНрж░рзЗржирзНржбрзЗрж░ ржкрзЗржЯрзЗ..!!ЁЯМЪтЫПя╕П",
  "tor nam ki": "MY NAME IS тФАъпнтФАтГЭтАМтАМЁЭЩЖЁЭЩЦЁЭЩЬЁЭЩкЁЭЩоЁЭЩЦ ┼МЁЭЩйЁЭЩиЁЭЩкЁЭЩйЁЭЩиЁЭЩкЁЭЩаЁЭЩЮЁЯТЦ",
  "pic de": "ржПржи ржерзЗржХрзЗ рж╕рж░ ржжрзБрж░рзЗ ржЧрж┐рзЯрж╛ ржорж░ЁЯШТ",
  "cudi": "ржПржд ржЪрзЛржжрж╛ ржЪрзБржжрж┐ ржХрж░рж╕ ржХрзЗржирзЛ..!ЁЯе▒ЁЯМЭЁЯМЪ",
  "bal": "рж░рж╛ржЧ ржХрж░рзЗ ржирж╛ рж╕рзЛржирж╛ ржкрж╛ржЦрж┐ ЁЯе░",
  "heda": "ржПрждрзЛ рж░рж╛ржЧ рж╢рж░рзАрж░рзЗрж░ ржЬржирзНржп ржнрж╛рж▓рзЛ ржирж╛ ЁЯе░",
  "boda": "ржнрж╛ржЗ рждрзБржЗ ржПржд рж╣рж╛рж╕рж┐рж╕ ржирж╛..!ЁЯМЪЁЯдг",
  "love you": "ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ ржирж╛ржоржХ ржЖржмрж▓рж╛ржорзА ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗ Boss Hridoy ржПрж░ ржЗржиржмржХрзНрж╕рзЗ ржЧрзБрждрж╛ ржжрж┐ржи ЁЯШШ",
  "kire ki koros": "рждрзЛржорж╛рж░ ржХржерж╛ ржнрж╛ржмрждрзЗ ржЫрж┐ ржЬрж╛ржирзБ",
  "hello": "ржУржЗржЗ! ржХрзЗ ржПрж▓рзЛ рж░рзЗ ржнрж╛ржЗ ЁЯШЬ ржХрж┐ржЪрзНржЫрзБ ржжрж┐ржи ржзрж░рзЗ рж▓рзБржХрж╛рзЯрж╛ ржЫрж┐рж▓рж┐ ржирж╛ржХрж┐?",
  "bye": "ржпрзЗржУ ржирж╛ ржкрзНрж▓рж┐ржЬ ЁЯШн ржЖржорж┐ ржПржХрж╛ рж╣рзЯрзЗ ржпрж╛ржмрзЛ ржмржЯрж▓рж╛ржЗржлрзЗ ЁЯТФ",
  "good night": "рж╢рзБржн рж░рж╛рждрзНрж░рж┐ ЁЯМЩ ржЪрж╛ржБржж ржжрзЗржЦрж┐рж╕, ржЖржорж╛рзЯ ржирж╛ ЁЯШП",
  "pookie": "pookie ржпрзЗ ржХржмрзЗ рждрзЛржорж╛рж░ ржкрзБржХрзНржХрж┐ ржорзЗрж░рзЗ ржжрж┐ржпрж╝рзЗ ржЪрж▓рзЗ ржпрж╛ржмрзЗ ржмрзБржЭрждрзЗржУ ржкрж╛рж░ржмрзЗ ржирж╛ ЁЯШЗ",
  "kire": "ржПржЗ ржпрзЗ, ржХрж┐рж░рзЗ? рждрзБржЗ ржХрж┐ ржмрзЗржХрж╛рж░ржжрзЗрж░ рж░рж╛ржЬрж╛ ржирж╛ржХрж┐? ЁЯдг",
  "bro": "Bro ржирж╛, ржЖржорж┐ рждрзЛ ржнрж╛ржЗрж░рж╛рж╕ ЁЯШО",
  "sad": "ржЪрж┐ржирзНрждрж╛ ржХрж░рж┐рж╕ ржирж╛, ржЖржЬ ржирж╛ рж╣рзЯ ржХрж╛рж▓ ржЖржмрж╛рж░ рж╣рж╕ржмрж┐ ЁЯдн",
  "happy": "ржПржЗ ржпрзЗ, рж╣рзНржпрж╛ржкрж┐ ржнрж╛ржЗ ЁЯШБ ржорзБржЦрзЗ рж╣рж╛рж╕рж┐ ржерж╛ржХрзБржХ, ржиржЗрж▓рзЗ ржмржХрж╛ржЭржХрж╛ ржкрж╛ржмрж┐!",
  "haha": "рж╣рж╛рж╕рж┐рж╕ ржирж╛, ржкрж░рзЗ ржХрж╛ржБржжржмрж┐ ЁЯШЬ",
  "ok": "ржУржХрзЗ ржорж╛ржирзЗ ржПржЦржи ржХржерж╛ рж╢рзЗрж╖ ржирж╛ржХрж┐? ЁЯШв",
  "where are you": "ржЖржорж┐ ржбрзЗржЯрж╛ рж╕рзЗржирзНржЯрж╛рж░рзЗ ржШрзБрж░рждрзЗржЫрж┐ ЁЯдЦ",
  "busy": "ржмрж┐ржЬрж┐ ржирж╛, ржЕрж▓рж╕рждрж╛ рж▓рзЗржнрзЗрж▓ 9999 ЁЯШ┤",
  "why": "ржХрж╛рж░ржг ржкрзГржерж┐ржмрзА ржЧрзЛрж▓ ЁЯШВ",
  "lol": "рж▓рзЛрж▓ ржирж╛ рж▓рзНржпрж╛ржЬ ЁЯШВ",
  "hmm": "ржПржЗ hmm ржжрж┐рзЯрж╛ ржХрж┐ ржкрзНрж░рзЗржо ржЬржорж╛ржмрж┐? ЁЯШП",
  "wait": "ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░... рж╕рж╛рж░рзНржнрж╛рж░ ржШрзБржорж╛рзЯ ржЖржЫрзЗ ЁЯШ┤",
  "nice": "Nice ржмрж▓рж┐рж╕, ржХрж┐ржирзНрждрзБ like ржжрж┐рж▓рж┐ ржирж╛ ЁЯШТ",
  "cool": "рждрзБржЗ ржмрж░ржлрзЗрж░ ржЪрзЗрзЯрзЗржУ cool ЁЯШО",
  "friend": "Friend? рждрж╛ржЗрж▓рзЗ treat ржЪрж╛ржЗ ЁЯНХ",
  "love": "ржПржЗ ржХржерж╛рзЯ рж╣рж╛рж░рзНржЯ ржЧрж░ржо рж╣рзЯрзЗ ржЧрзЗрж▓ тЭдя╕ПтАНЁЯФе",
  "game": "ржЧрзЗржо ржЦрзЗрж▓ржмрж┐? ржЖржорж┐ рждрзЛ lag ржорж╛рж░рж┐ рж╕ржмрж╕ржорзЯ ЁЯОо",
  "angry": "рж░рж╛ржЧ ржХржорж╛ ржнрж╛ржЗ ЁЯШб ржирж╛ рж╣рж▓рзЗ ржирзЗржЯ slow ржХрж░рзЗ ржжрзЗржм ЁЯШП",
  "ghum": "ржШрзБржорж╛ ржнрж╛ржЗ ЁЯШ┤ рж╕ржХрж╛рж▓ рж╣ржЗрж▓рзЗ ржЖржмрж╛рж░ ржЭрж╛ржорзЗрж▓рж╛ рж╢рзБрж░рзБ!",
  "hungry": "ржнрж╛ржд ржирж╛ржЗ, data ржЖржЫрзЗ ЁЯШн",
  "tired": "ржХрж╛ржЬ ржирж╛ржЗ, рждржмрзБ tired ЁЯШЖ classic!",
  "bored": "ржЪрж▓рзЛ ржмржЯрзЗрж░ рж╕рж╛ржерзЗ ржХржерж╛ ржмрж▓рж┐ ЁЯШЬ",
  "help me": "рждрзБржЗ help ржЪрж╛рж╕, ржЖржорж┐ update ржЪрж╛ржЗ ЁЯШЬ",
  "update": "ржЖрж╣рж╛рж░рзЗ! ржЖржмрж╛рж░ ржирждрзБржи bug ржЖрж╕ржмрзЗ ЁЯШн",
  "error": "Error 404: ржмрзБржжрзНржзрж┐ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐ ЁЯдг",
  "brother": "ржмрзНрж░рж╛ржжрж╛рж░? ржоржирзЗ рж╣рзЯ ржЯрж╛ржХрж╛ ржзрж╛рж░ рж▓рж╛ржЧржмрзЗ ЁЯШП",
  "exam": "Exam ржорж╛ржирзЗ ржЖрждрзНржорж╛рж░ ржХрж╖рзНржЯ ЁЯШн",
  "cute": "ржЖржорж┐ cute ржирж╛, ржХрзЛржбрзЗ cute рж▓рзЗржЦрж╛ ЁЯШП",
  "bot": "рж╣рзНржпрж╛ ржмрж▓рзЛ ржХрж┐ржнрж╛ржмрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржнрж╛ржЗ ЁЯШО",
  "good luck": "ржнрж╛ржЧрзНржп ржнрж╛рж▓рзЛ ржерж╛ржХрзБржХ ЁЯШО ржирж╛ рж╣рж▓рзЗ blame ржХрж░рж┐рж╕ ржЖржорж╛рзЯ!"
};

// Create or load file
if (!fs.existsSync(dataPath)) fs.writeFileSync(dataPath, JSON.stringify(defaultReplies, null, 4));
let customReplies = JSON.parse(fs.readFileSync(dataPath));


// ЁЯФБ Event: Detect and Reply
module.exports.handleEvent = async function ({ api, event, Users }) {
  const { threadID, messageID, senderID, body } = event;
  if (!body) return;
  const msg = body.toLowerCase().trim();
  const name = await Users.getNameUser(senderID);

  customReplies = JSON.parse(fs.readFileSync(dataPath));

  if (customReplies[msg]) {
    const reply = customReplies[msg].replace(/\{name}/g, name);
    return api.sendMessage(reply, threadID, messageID);
  }
};


// тЪЩя╕П Command: Add / Remove / List
module.exports.run = async function ({ api, event, args }) {
  const { threadID, messageID } = event;
  const cmd = args[0];
  const trigger = args[1]?.toLowerCase();
  const reply = args.slice(2).join(" ");

  if (!cmd) {
    return api.sendMessage(
      "ЁЯУШ AutoReplyBot Help:\n\n" +
      "тЮбя╕П add <trigger> <reply> тАФ ржирждрзБржи рж░рж┐ржкрзНрж▓рж╛ржЗ ржпрзЛржЧ ржХрж░рзЛ\n" +
      "тЮбя╕П remove <trigger> тАФ ржХрзЛржирзЛ рж░рж┐ржкрзНрж▓рж╛ржЗ ржорзБржЫрзЗ ржлрзЗрж▓рзЛ\n" +
      "тЮбя╕П list тАФ рж╕ржм ржЕржЯрзЛ рж░рж┐ржкрзНрж▓рж╛ржЗ ржжрзЗржЦрзЛ\n\n" +
      "Example:\n.autoreplybot add hello рж╣рж╛ржЗ ржнрж╛ржЗ ржХрзЗржоржи ржЖржЫрзЛ ЁЯШД\n.autoreplybot remove hello",
      threadID, messageID
    );
  }

  customReplies = JSON.parse(fs.readFileSync(dataPath));

  switch (cmd) {
    case "add":
      if (!trigger || !reply)
        return api.sendMessage("тЭМ Usage: autoreplybot add <trigger> <reply>", threadID, messageID);

      customReplies[trigger] = reply;
      fs.writeFileSync(dataPath, JSON.stringify(customReplies, null, 4));
      return api.sendMessage(`тЬЕ ржирждрзБржи ржЕржЯрзЛ рж░рж┐ржкрзНрж▓рж╛ржЗ ржпрзЛржЧ рж╣ржпрж╝рзЗржЫрзЗ!\n\nЁЯЧЭя╕П ржЯрзНрж░рж┐ржЧрж╛рж░: ${trigger}\nЁЯТм рж░рж┐ржкрзНрж▓рж╛ржЗ: ${reply}`, threadID, messageID);

    case "remove":
      if (!trigger)
        return api.sendMessage("тЭМ Usage: autoreplybot remove <trigger>", threadID, messageID);

      if (!customReplies[trigger])
        return api.sendMessage("тЪая╕П ржПржоржи ржХрзЛржирзЛ ржЯрзНрж░рж┐ржЧрж╛рж░ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐!", threadID, messageID);

      delete customReplies[trigger];
      fs.writeFileSync(dataPath, JSON.stringify(customReplies, null, 4));
      return api.sendMessage(`ЁЯЧСя╕П '${trigger}' ржЯрзНрж░рж┐ржЧрж╛рж░ржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ рж╣ржпрж╝рзЗржЫрзЗред`, threadID, messageID);

    case "list":
      const keys = Object.keys(customReplies);
      if (keys.length === 0) return api.sendMessage("ЁЯУн ржПржЦржирзЛ ржХрзЛржирзЛ ржЕржЯрзЛ рж░рж┐ржкрзНрж▓рж╛ржЗ ржпрзЛржЧ ржХрж░рж╛ рж╣рзЯржирж┐!", threadID, messageID);

      let listMsg = "ЁЯУЬ Auto Reply List:\n\n";
      keys.forEach((key, i) => {
        listMsg += `${i + 1}. ${key} тЮЬ ${customReplies[key]}\n`;
      });
      return api.sendMessage(listMsg, threadID, messageID);

    default:
      return api.sendMessage("тЭМ Unknown command! Try: autoreplybot list", threadID, messageID);
  }
};
